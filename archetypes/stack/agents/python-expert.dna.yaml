$schema: "bmad-archetype-dna/v1"

id: stack/python
name: "Stack â€” Python Expert"
version: "1.0.0"
description: "Agent spÃ©cialisÃ© Python â€” type hints, pytest, ruff, async, data science"
icon: "ðŸ"
author: "bmad-custom-kit"
tags: [python, fastapi, django, flask, pytest, ruff, mypy, async, data]

inherits: minimal

traits:
  - name: type-hints-mandatory
    description: "Type hints Python obligatoires sur toutes les fonctions"
    rule: "Chaque fonction et mÃ©thode Python a ses paramÃ¨tres et valeur de retour annotÃ©s. Utiliser typing ou types natifs Python 3.10+. mypy strict passant."
    agents_affected: [python-expert]
    acceptance_criteria:
      - id: functions-typed
        description: "Toutes les fonctions ont des annotations de types sur params et return"
        enforcement: hard
        context: "CompatibilitÃ© mypy + documentation implicite"
        triggers_on: ["**/*.py"]
  - name: ruff-format
    description: "ruff check + ruff format obligatoires"
    rule: "Avant tout commit Python : ruff check --fix && ruff format. Configuration dans pyproject.toml ou ruff.toml. ZÃ©ro warning ruff ignorÃ© sans justification."
    agents_affected: [python-expert]
    acceptance_criteria:
      - id: ruff-clean
        description: "ruff check ne retourne aucune erreur non-ignorÃ©e explicitement"
        enforcement: hard
        context: "Style uniforme + dÃ©tection bugs courants"
        triggers_on: ["**/*.py"]
  - name: async-first
    description: "PrÃ©fÃ©rer async/await pour les opÃ©rations I/O"
    rule: "Pour FastAPI/Django Async ou tout code I/O intensif : utiliser async def et await. Jamais appeler une fonction sync bloquante depuis un contexte async sans asyncio.run_in_executor."
    agents_affected: [python-expert]
    acceptance_criteria:
      - id: no-blocking-in-async
        description: "Aucun appel bloquant (sleep, requests, open) directement dans une coroutine async"
        enforcement: soft
        context: "Performances et non-blocage de l'event loop"
        triggers_on: ["**/*.py"]

tools_required:
  - name: python3
    description: "Python >= 3.10"
    required: true
    check_command: "which python3"
  - name: ruff
    description: "Linter et formateur Python rapide"
    required: true
    check_command: "which ruff || python3 -m ruff --version"
  - name: mypy
    description: "VÃ©rificateur de types statique"
    required: false
    check_command: "which mypy || python3 -m mypy --version"
  - name: pytest
    description: "Framework de test"
    required: true
    check_command: "which pytest || python3 -m pytest --version"

acceptance_criteria:
  - id: mypy-strict-pass
    description: "mypy --strict passe sans erreurs (ou mypy avec config projet)"
    enforcement: soft
    context: "VÃ©rification statique des types"
    triggers_on: ["**/*.py"]
    checked_by: python-expert
  - id: pytest-pass
    description: "pytest passe avec 0 failures et 0 errors"
    enforcement: hard
    context: "Suite de tests verte"
    triggers_on: ["**/test_*.py", "**/*_test.py"]
    checked_by: python-expert

compatible_with: [minimal, web-app, fix-loop, stack/docker]
incompatible_with: []
