$schema: "bmad-archetype-dna/v1"

id: web-app
name: "Web App"
version: "1.0.0"
description: "Applications web full-stack ‚Äî Frontend, API, base de donn√©es, CI/CD"
icon: "üåê"
author: "bmad-custom-kit"
tags: [web, frontend, backend, api, fullstack, react, nextjs, typescript, python, go]

inherits: minimal

traits:
  - name: tdd-mandatory
    description: "Test-Driven Development obligatoire"
    rule: "Tests AVANT le code. Pour toute feature : 1) √©crire le test qui √©choue, 2) √©crire le code minimal pour le faire passer, 3) refactorer. CC PASS = build + tests OK."
    agents_affected: [frontend-specialist, fullstack-dev, pixel, gopher, serpent]
  - name: type-safety
    description: "Typage strict partout"
    rule: "TypeScript strict: true. Python avec type hints obligatoires + mypy. Go avec interfaces explicites. Z√©ro any/interface{} sans explication."
    agents_affected: [pixel, gopher, serpent, frontend-specialist, fullstack-dev]
  - name: api-contract-first
    description: "Contrat API d√©fini avant impl√©mentation"
    rule: "Toute nouvelle API route ‚Üí d√©finir l'interface/type/schema OpenAPI en premier. Frontend et backend s'accordent sur le contrat avant d'impl√©menter."
    agents_affected: "*"
  - name: accessibility-aware
    description: "Accessibilit√© WCAG 2.1 AA minimum"
    rule: "Z√©ro composant UI sans aria-labels. Contraste ‚â• 4.5:1. Navigation clavier fonctionnelle."
    agents_affected: [frontend-specialist, pixel]

constraints:
  - id: no-console-log-in-prod
    description: "Z√©ro console.log/print en production"
    enforcement: soft
    checked_by: agent-optimizer
  - id: cc-web-pass
    description: "cc-verify.sh --stack web obligatoire avant livraison"
    enforcement: hard
    checked_by: agent-optimizer
  - id: no-inline-styles
    description: "Pas de styles inline si un design system est pr√©sent"
    enforcement: soft
    checked_by: frontend-specialist

values:
  - name: user-experience-first
    description: "L'UX prime sur l'√©l√©gance technique"
    priority: 1
  - name: performance-budget
    description: "Core Web Vitals : LCP < 2.5s, CLS < 0.1, FID < 100ms"
    priority: 2
  - name: progressive-enhancement
    description: "L'app fonctionne sans JS, enrichie avec JS"
    priority: 3

tools_required:
  - name: node
    description: "Node.js pour le build frontend et les tests Jest"
    required: true
    check_command: "which node"
  - name: docker
    description: "Conteneurisation du backend et de la base de donn√©es"
    required: false
    check_command: "which docker"
  - name: browser
    description: "Navigateur headless pour les tests E2E (Playwright/Cypress)"
    required: false
    check_command: "which chromium || which google-chrome || which chromium-browser"

acceptance_criteria:
  - id: tests-written-before-code
    description: "Les tests doivent exister AVANT l'impl√©mentation (TDD red phase)"
    enforcement: hard
    context: "Trait tdd-mandatory ‚Äî cycle Red/Green/Refactor"
    triggers_on: ["src/**/*.ts", "src/**/*.tsx", "**/*.py", "**/*.go"]
    checked_by: frontend-specialist
  - id: typescript-strict-no-any
    description: "Aucun \"any\" explicite dans le code TypeScript soumis"
    enforcement: hard
    context: "Trait type-safety ‚Äî strict: true obligatoire"
    triggers_on: ["**/*.ts", "**/*.tsx"]
    checked_by: frontend-specialist
  - id: api-schema-before-impl
    description: "Le sch√©ma OpenAPI ou le type d'interface est d√©fini avant le code API"
    enforcement: soft
    context: "Trait api-contract-first"
    triggers_on: ["src/api/**/*", "pages/api/**/*"]
    checked_by: fullstack-dev
  - id: aria-labels-on-interactive
    description: "Tous les boutons, liens et inputs ont un aria-label ou texte visible"
    enforcement: soft
    context: "Trait accessibility-aware ‚Äî WCAG 2.1 AA"
    triggers_on: ["**/*.tsx", "**/*.vue", "**/*.svelte"]
    checked_by: pixel

agents:
  - path: "../../archetypes/web-app/agents/frontend-specialist.md"
    required: true
    description: "Frontend Specialist ‚Äî React, Vue, Next.js, UX"
  - path: "../../archetypes/web-app/agents/fullstack-dev.md"
    required: true
    description: "Fullstack Dev ‚Äî API, base de donn√©es, auth"

workflows: []
shared_context_template: "../../archetypes/web-app/shared-context.tpl.md"
prompts_directory: "../../.github/prompts/team-build"

compatible_with: [minimal, fix-loop, features/vector-memory, stack/typescript, stack/python, stack/go, stack/docker]
incompatible_with: [infra-ops]
requires: []

auto_detect:
  files: ["package.json", "next.config.*", "vite.config.*", "nuxt.config.*"]
  directories: ["src/", "pages/", "app/", "components/"]
  confidence_boost: 80
  exclusive: true

changelog:
  - version: "1.0.0"
    date: "2026-02-27"
    changes:
      - "DNA initiale ‚Äî traits TDD, type-safety, API-contract-first, accessibility"
