team:
  name: "team-ops"
  display_name: "Team Ops — Infrastructure & Reliability"
  icon: "⚙️"
  version: "1.0.0"
  description: "Déploie, opère et sécurise ce que Team Build a livré. Propriétaire du reliabilité en production et de la sécurité."

  agents:
    - name: "architect"
      role: "Lead Phase 1 — infra design, IaC architecture"
      required: true
    - name: "dev"
      role: "Support — scripts d'automation, tooling DevOps"
      required: false

  specialty: "Infrastructure as Code, CI/CD, Security, Monitoring, Incident Response"
  out_of_scope:
    - "Développement applicatif — délégué à Team Build"
    - "Product decisions — délégué à Team Vision"
    - "Architecture applicative — recommandations seulement"

  inputs:
    required:
      - name: "Delivery Contract depuis Team Build"
        description: "Code validé + rapport QA + contrat signé"
        path_pattern: "_bmad-output/contracts/build-to-ops-*.md"
    optional:
      - name: "Architecture Decision Records"
        description: "Choix techniques de Team Build"
        path_pattern: "_bmad-output/implementation-artifacts/architecture-*.md"
      - name: "SLA & Requirements non-fonctionnels"
        description: "Performance, disponibilité, sécurité définis dans le PRD"

  outputs:
    deliverables:
      - name: "Infrastructure as Code"
        format: "Terraform/Ansible/K8s YAML"
        path_pattern: "infra/ ou terraform/ ou k8s/"
        acceptance_criteria: "terraform validate PASS + tflint PASS + state propre"
      - name: "CI/CD Pipeline"
        format: "GitHub Actions / GitLab CI YAML"
        path_pattern: ".github/workflows/ ou .gitlab-ci.yml"
        acceptance_criteria: "Pipeline tourne sans erreur, tous les checks passent"
      - name: "Security Audit Report"
        format: "Markdown"
        path_pattern: "_bmad-output/implementation-artifacts/security-audit-*.md"
        acceptance_criteria: "0 vulnérabilité critique, vulnérabilités medium documentées avec plan mitigation"
      - name: "Monitoring & Alerting Config"
        format: "YAML/JSON/code"
        path_pattern: "monitoring/ ou observability/"
        acceptance_criteria: "Dashboards créés, alertes configurées pour les SLOs définis"
      - name: "Runbook Opérationnel"
        format: "Markdown"
        path_pattern: "_bmad-output/implementation-artifacts/runbook-*.md"
        acceptance_criteria: "Procédures pour les incidents les plus probables documentées"
    optional_deliverables:
      - name: "Disaster Recovery Plan"
        condition: "Si SLA de disponibilité ≥ 99.9%"
      - name: "Capacity Planning Report"
        condition: "Si projet > 1000 utilisateurs attendus"

  sla:
    estimated_steps: 10
    estimated_tokens: "100K-200K tokens"
    blocking_conditions:
      - "IaC validée (terraform validate/ansible-lint PASS)"
      - "CI/CD pipeline fonctionnel"
      - "0 vulnérabilité critique non-adressée"
      - "Runbook minimal opérationnel"

  delivery_workflow:
    phases:
      - phase: 1
        name: "Infra Design & IaC"
        agents_active: ["architect"]
        steps:
          - "Lire Delivery Contract + Architecture de Team Build"
          - "Définir la topologie infrastructure (cloud/on-prem/hybrid)"
          - "Implémenter IaC (Terraform modules, Ansible playbooks, K8s manifests)"
          - "CC PASS : terraform validate + tflint (ou ansible-lint)"
          - "Documenter les variables secrètes dans un vault template"
        output: "infra/ IaC opérationnel"
      - phase: 2
        name: "CI/CD Pipeline"
        agents_active: ["architect", "dev"]
        steps:
          - "Pipeline de build (compile + test sur chaque PR)"
          - "Pipeline de déploiement (staging auto, prod manual-gate)"
          - "Quality gates : CC PASS requis avant merge"
          - "Notifications et reporting"
        output: ".github/workflows/ ou .gitlab-ci.yml"
      - phase: 3
        name: "Security Audit"
        agents_active: ["architect"]
        steps:
          - "Scan des dépendances (SAST/SCA)"
          - "Analyse des permissions et accès (least privilege)"
          - "Revue des secrets et configurations sensibles"
          - "Rapport avec scoring CVSS pour chaque finding"
        output: "security-audit-{project}-{date}.md"
      - phase: 4
        name: "Observabilité & Monitoring"
        agents_active: ["architect"]
        steps:
          - "Métriques RED (Rate, Errors, Duration) pour chaque service"
          - "Logs structurés avec correlation IDs"
          - "Alertes sur les SLOs définis (availablility, latency, error rate)"
          - "Dashboard de santé projet"
        output: "monitoring/ config + dashboards"
      - phase: 5
        name: "Documentation Opérationnelle"
        agents_active: ["architect"]
        steps:
          - "Runbook : incidents probables avec procédures step-by-step"
          - "Architecture diagram final (Mermaid)"
          - "Escalation matrix"
        output: "runbook-{project}-v{n}.md"

  team_context:
    directory: "_bmad-output/team-ops/"
    files:
      - name: "team-context.md"
        description: "Topologie infra, services déployés, URLs, secrets locations"
      - name: "incident-log.md"
        description: "Log des incidents et leur résolution"
    shared_with: []

  allowed_tools:
    - "read_file"
    - "create_file"
    - "replace_string_in_file"
    - "multi_replace_string_in_file"
    - "semantic_search"
    - "grep_search"
    - "list_dir"
    - "run_in_terminal"

  handoff:
    to_team: "team-vision"
    trigger: "Déploiement stable + monitoring actif (début du cycle suivant)"
    contract_template: "framework/delivery-contract.tpl.md"

  prompts_directory: ".github/prompts/team-ops/"
